{{- if .Values.secrets.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "agentbox.secretName" . }}
  labels:
    {{- include "agentbox.labels" . | nindent 4 }}
type: Opaque
data:
  # Required: JWT signing secret (used by auth service)
  AGENTBOX_JWT_SECRET: {{ .Values.secrets.jwtSecret | b64enc | quote }}
  # Required: Auth secret (used by config validation - should match JWT_SECRET)
  AGENTBOX_AUTH_SECRET: {{ .Values.secrets.jwtSecret | b64enc | quote }}
  
  # Admin credentials
  {{- if .Values.secrets.adminUsername }}
  AGENTBOX_ADMIN_USERNAME: {{ .Values.secrets.adminUsername | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.adminPassword }}
  AGENTBOX_ADMIN_PASSWORD: {{ .Values.secrets.adminPassword | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.adminEmail }}
  AGENTBOX_ADMIN_EMAIL: {{ .Values.secrets.adminEmail | b64enc | quote }}
  {{- end }}
  
  # Google OAuth credentials (optional)
  {{- if .Values.secrets.googleClientId }}
  AGENTBOX_GOOGLE_CLIENT_ID: {{ .Values.secrets.googleClientId | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.googleClientSecret }}
  AGENTBOX_GOOGLE_CLIENT_SECRET: {{ .Values.secrets.googleClientSecret | b64enc | quote }}
  {{- end }}
  
  # Database credentials (optional, for PostgreSQL)
  {{- if .Values.secrets.databaseDSN }}
  AGENTBOX_DB_DSN: {{ .Values.secrets.databaseDSN | b64enc | quote }}
  {{- end }}
{{- end }}
