apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "agentbox.fullname" . }}-config
  labels:
    {{- include "agentbox.labels" . | nindent 4 }}
data:
  config.yaml: |
    server:
      port: {{ .Values.config.server.port }}
      host: "{{ .Values.config.server.host }}"
      log_level: "{{ .Values.config.server.log_level }}"
    
    kubernetes:
      kubeconfig: "{{ .Values.config.kubernetes.kubeconfig }}"
      namespace_prefix: "{{ .Values.config.kubernetes.namespace_prefix }}"
      runtime_class: "{{ .Values.config.kubernetes.runtime_class }}"
    
    auth:
      enabled: {{ .Values.config.auth.enabled }}
      {{- if .Values.config.auth.secret }}
      secret: "{{ .Values.config.auth.secret }}"
      {{- else }}
      secret: ""
      {{- end }}
    
    resources:
      default_cpu_limit: "{{ .Values.config.resources.default_cpu_limit }}"
      default_memory_limit: "{{ .Values.config.resources.default_memory_limit }}"
      default_storage_limit: "{{ .Values.config.resources.default_storage_limit }}"
      max_environments_per_user: {{ .Values.config.resources.max_environments_per_user }}
    
    timeouts:
      default_timeout: {{ .Values.config.timeouts.default_timeout }}
      max_timeout: {{ .Values.config.timeouts.max_timeout }}
      startup_timeout: {{ .Values.config.timeouts.startup_timeout }}
